# 경복궁 시간의 놀이문 - 작업 관리 문서

## 1. 프로젝트 개요

| 항목 | 내용 |
|------|------|
| 프로젝트명 | 경복궁 시간의 놀이문 |
| 개발 환경 | Unity 2022.3 LTS + VIVEN SDK |
| 게임 구조 | 단일 씬, 5개 영역 (스토리 기반) |
| 예상 작업량 | 총 42개 태스크 |

### 게임 구성
- **Round 1**: 판돌 건너기 (발판 선택 + 균형 게임)
- **Round 2**: 비석치기 (돌 던져 비석 맞추기)

### 씬 영역 구성 (6개 영역)
0. 로딩 (Area_00_Loading)
1. 프롤로그 - 현대 경복궁 (Area_01_Prologue) ← 시작 영역
2. 타임리프 (Area_02_Timeleap)
3. 판돌 건너기 게임장 (Area_03_Pandol)
4. 비석치기 게임장 (Area_04_Biseok)
5. 엔딩 (Area_05_Ending)

---

## 2. 마일스톤

### M1: 프로젝트 셋업 (Phase 1)
- [ ] 프로젝트 구조 설정
- [ ] 공통 시스템 구현
- [ ] 씬 영역 기본 구조
- 예상 기간: 2일

### M2: 스토리 시스템 (Phase 2)
- [ ] 현대 경복궁 영역
- [ ] 타임슬립 연출
- [ ] 도깨비 NPC 시스템
- 예상 기간: 2일

### M3: 판돌 건너기 (Phase 3)
- [ ] 발판 시스템
- [ ] 낙하/클리어 로직
- [ ] 게임 로직 완성
- 예상 기간: 3일

### M4: 비석치기 (Phase 4)
- [ ] 던지기 물리 시스템
- [ ] 비석 충돌 감지
- [ ] 게임 로직 완성
- 예상 기간: 3일

### M5: 통합 및 QA (Phase 5)
- [ ] 영역 전환 연출
- [ ] 전체 통합 테스트
- [ ] 최적화 및 빌드
- 예상 기간: 2일

---

## 3. 상세 태스크 목록

### Phase 1: 프로젝트 셋업 (8 태스크)

#### 1.1 폴더 구조 및 씬 설정
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| P1-01 | Assets/TraditionalGames 폴더 구조 확인 | ✅ 완료 | 높음 | |
| P1-02 | Scripts 폴더 구조 생성 (Manager, Objects, UI, Utils) | ✅ 완료 | 높음 | |
| P1-03 | 메인 씬 생성 (GyeongbokgungGame.unity) | ✅ 완료 | 높음 | |
| P1-04 | 5개 영역 빈 게임오브젝트 구조 생성 | ✅ 완료 | 높음 | |

#### 1.2 공통 시스템 구현
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| P1-05 | GameFlowManager.lua 기본 구조 작성 | ✅ 완료 | 높음 | |
| P1-06 | StageManager.lua 구현 (자막/UI 표시) | ✅ 완료 | 높음 | |
| P1-07 | FadeTransition 구현 (UI.FadeIn/FadeOut) | ✅ 완료 | 중간 | |
| P1-08 | AudioManager.lua 설정 | ✅ 완료 | 중간 | |

---

### Phase 2: 스토리 시스템 (8 태스크)

#### 2.1 프롤로그
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| S-01 | (제외됨 - 로딩 화면 별도 불필요) | - | - | |
| S-02 | 현대 경복궁 3D 환경 배치 | 🔄 진행중 | 높음 | |
| S-03 | 보따리 오브젝트 및 트리거 설정 | ✅ 완료 | 높음 | |
| S-04 | BottariTrigger.lua 작성 | ✅ 완료 | 높음 | |

#### 2.2 타임리프 연출
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| S-05 | TimeleapManager.lua 작성 | ✅ 완료 | 높음 | |
| S-06 | 타임리프 연출 (페이드, 파티클) | 🔄 진행중 | 중간 | |

#### 2.3 도깨비 NPC
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| S-07 | 도깨비 캐릭터 모델 배치 | ✅ 완료 | 중간 | |
| S-08 | GoblinNPC.lua 대화/등장 시스템 | ✅ 완료 | 중간 | |

---

### Phase 3: 판돌 건너기 (10 태스크)

#### 3.1 환경 구성
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| PD-01 | 판돌 건너기 영역 구성 | ⬜ TODO | 높음 | |
| PD-02 | 시작/골 플랫폼 배치 | ⬜ TODO | 높음 | |
| PD-03 | FallZone 설정 | ⬜ TODO | 높음 | |

#### 3.2 발판 시스템
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| PD-04 | 안전 발판 프리팹 생성 | ⬜ TODO | 높음 | |
| PD-05 | 깨지는 발판 프리팹 생성 | ⬜ TODO | 높음 | |
| PD-06 | PlatformStep.lua 작성 | ✅ 완료 | 높음 | |

#### 3.3 게임 로직
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| PD-07 | PandolManager.lua 작성 | ✅ 완료 | 높음 | |
| PD-08 | 발판 랜덤 생성 로직 | ✅ 완료 | 높음 | |
| PD-09 | 낙하 감지 및 리스폰 | ✅ 완료 | 높음 | |

#### 3.4 UI 및 피드백
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| PD-10 | 깨지는 효과 (파티클, 사운드) | 🔄 진행중 | 중간 | |

---

### Phase 4: 비석치기 (10 태스크)

#### 4.1 환경 구성
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| BS-01 | 비석치기 영역 구성 | ⬜ TODO | 높음 | |
| BS-02 | 비석 3개 배치 | ⬜ TODO | 높음 | |
| BS-03 | 투척 라인 마커 배치 | ⬜ TODO | 낮음 | |

#### 4.2 오브젝트 스크립트
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| BS-04 | 던지는 돌 프리펙 생성 (Grabbable) | ⬜ TODO | 높음 | |
| BS-05 | ThrowingStone.lua 작성 | ✅ 완료 | 높음 | |
| BS-06 | BiseokObject.lua 작성 | ✅ 완료 | 높음 | |

#### 4.3 게임 로직
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| BS-07 | BiseokManager.lua 작성 | ✅ 완료 | 높음 | |
| BS-08 | 비석 쓰러짐 판정 로직 | ✅ 완료 | 높음 | |
| BS-09 | 시도 횟수 및 성공/실패 판정 | ✅ 완료 | 중간 | |

#### 4.4 UI 및 피드백
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| BS-10 | 합틱 피드백 및 사운드 추가 | ✅ 완료 | 중간 | |

---

### Phase 5: 통합 및 QA (6 태스크)

#### 5.1 영역 전환 및 연출
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| Q-01 | 라운드 클리어 → 다음 라운드 전환 | ✅ 완료 | 높음 | |
| Q-02 | 엔딩 연출 (EndingManager.lua) | ✅ 완료 | 중간 | |
| Q-03 | 현대 복귀 연출 | ✅ 완료 | 중간 | |

#### 5.2 QA 및 최적화
| ID | 태스크 | 상태 | 우선순위 | 담당 |
|----|--------|------|----------|------|
| Q-04 | 전체 플로우 테스트 | ⬜ TODO | 높음 | |
| Q-05 | 성능 최적화 (프로파일링) | ⬜ TODO | 중간 | |
| Q-06 | 최종 빌드 및 테스트 | ⬜ TODO | 높음 | |

---

## 4. 의존성 관계

```
Phase 1 (프로젝트 셋업)
    │
    ├──► Phase 2 (스토리 시스템)
    │        │
    │        └──► Phase 3 (판돌 건너기)
    │                  │
    │                  └──► Phase 4 (비석치기)
    │                            │
    │                            └──► Phase 5 (통합 및 QA)
    │
    └──► (공통 시스템은 모든 Phase에서 사용)
```

### 핵심 의존성
| 태스크 | 선행 태스크 |
|--------|-------------|
| P1-06 (AreaManager) | P1-03 (메인 씬) |
| S-04 (BottariTrigger) | P1-05 (GameFlowManager) |
| S-05 (TimeleapManager) | P1-06 (AreaManager) |
| PD-07 (PandolManager) | P1-05 (GameFlowManager) |
| BS-07 (BiseokManager) | P1-05 (GameFlowManager) |
| Q-01 (라운드 전환) | Phase 3~4 완료 |

---

## 5. 리소스 체크리스트

### 5.1 3D 모델
| 항목 | 상태 | 비고 |
|------|------|------|
| 현대 경복궁 환경 | ⬜ 필요 | 근정전 주변 |
| 보따리 오브젝트 | ⬜ 필요 | 파티클 효과 포함 |
| 도깨비 캐릭터 | ⬜ 필요 | NPC용 |
| 판돌 (안전/깨짐) | ⬜ 필요 | 2종류 |
| 비석 | ⬜ 필요 | 3개 |
| 던지는 돌 | ⬜ 필요 | Grabbable |

### 5.2 사운드
| 항목 | 상태 | 비고 |
|------|------|------|
| BGM (현대 경복궁) | ⬜ 필요 | 평화로운 분위기 |
| BGM (조선시대/게임) | ⬜ 필요 | 긴장감 있는 국악 |
| 타임리프 SFX | ⬜ 필요 | 종소리, 바람소리 |
| 유리 깨지는 SFX | ⬜ 필요 | 판돌용 |
| 돌 충돌 SFX | ⬜ 필요 | 비석치기용 |
| 성공/실패 SFX | ⬜ 필요 | |

### 5.3 UI 에셋
| 항목 | 상태 | 비고 |
|------|------|------|
| 로딩 화면 | ⬜ 필요 | 로고, 텍스트 |
| 자막 UI | ⬜ 필요 | 도깨비 대사용 |
| 토스트 메시지 | ⬜ 필요 | 성공/실패 알림 |

---

## 6. 진행 상황 요약

### 전체 진행률
```
Phase 1: ██████████ 100% (8/8)
Phase 2: ████████░░ 75% (6/8)
Phase 3: ████░░░░░░ 40% (4/10)
Phase 4: ██████░░░░ 60% (6/10)
Phase 5: █████░░░░░ 50% (3/6)
─────────────────────────────
전  체: ██████░░░░ 64% (27/42)
```

### 상태별 집계
| 상태 | 개수 |
|------|------|
| ⬜ TODO | 12 |
| 🔄 진행중 | 3 |
| ✅ 완료 | 27 |
| ❌ 차단됨 | 0 |

---

## 7. 스토리 플로우

```
[프롤로그 - 현대 경복궁] ← 시작 영역
    │ 보따리 트리거 진입 (카운트다운 5,4,3,2,1)
    ▼
[타임리프 연출]
    │ 도깨비: "두 가지 시험을 내리겠다"
    ▼
[Round 1: 판돌 건너기]
    │ 클리어
    ▼
[Round 2: 비석치기]
    │ 클리어
    ▼
[엔딩]
    │ 도깨비 인사 + 배지 지급
    ▼
[현대 경복궁으로 복귀]
```

---

## 8. 회의 및 업데이트 로그

### 2024-12-08 (현재)
- Phase 1 완료 (프로젝트 셋업 - 8개 태스크)
- Phase 2 진행 중 (스토리 시스템 - 4/8 완료)
- **주요 구현 완료**:
  - GameFlowManager.lua - 게임 흐름 및 영역 전환 관리
  - StageManager.lua - 자막/UI 표시 관리
  - AudioManager.lua - BGM/SFX 관리
  - TimeleapManager.lua - 타임리프 연출 시퀀스
  - BottariTrigger.lua - 보따리 상호작용 (자동 카운트다운)
- **기술적 변경사항**:
  - 로딩 영역 제외 (5개 영역으로 변경)
  - VIVEN SDK 호환: Debug.Log만 사용 (LogWarning/LogError 사용 불가)
  - NullableInject 패턴 적용 (선택적 컴포넌트 주입)
  - VR 컨트롤러 감지: 이름 기반 (Grabber, Placer, Interactor, Hand)
  - TMP_Text 접근: GameObject 주입 후 GetComponentInChildren 패턴

### 2024-XX-XX (초기)
- 프로젝트 시작
- PDF 설계서 기반 VIVEN SDK 적응 설계서 작성
- 작업 관리 문서 업데이트 (3게임 → 2게임)
- 무궁화 놀이 제외, 판돌+비석치기 집중
- 단일 씬 + 텔레포트 방식 확정

---

## 9. 위험 요소 및 대응

| 위험 요소 | 영향도 | 대응 방안 |
|-----------|--------|-----------|
| 발판 물리 불안정 | 중간 | Collider Off 방식 사용, 테스트 반복 |
| 비석 물리 튜닝 | 중간 | Continuous Dynamic, 각도 기반 판정 |
| 영역 전환 시 끊김 | 중간 | 프리로드, 페이드 전환 |
| 성능 이슈 (단일 씬) | 낮음 | 비활성 영역 컬링, LOD 적용 |

---

## 10. 체크인 규칙

### 커밋 메시지 형식
```
[Phase-ID] 작업 내용

예시:
[P1-05] GameFlowManager.lua 기본 구조 작성
[S-05] TimeleapManager.lua 타임리프 연출 구현
[PD-07] PandolManager.lua 발판 생성 로직
[BS-07] BiseokManager.lua 비석 쓰러짐 판정
```

### 브랜치 전략
- `main`: 안정 버전
- `develop`: 개발 통합
- `feature/[area-name]`: 영역별 기능 개발
  - `feature/story-system`
  - `feature/pandol`
  - `feature/biseok`
  - `feature/integration`
